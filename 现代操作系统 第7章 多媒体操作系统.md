# 现代操作系统 第7章 多媒体操作系统

- 数字电影、视频剪辑和音乐正在日益成为用计算机表示信息和进行消遣娱乐的常用方式。


- 目前的文件系统却是为文本文件设计的。
  - 因此，需要设计新型的文件系统来处理音频和视频文件。

  - 不仅如此，保存与回放音频和视频同样给调度程序以及操作系统的其他部分提出了新的要求


- 数字电影通常归于多媒体名下，多媒体的字面含义是一种以上的媒体。


- “多媒体”这一术语时所指的是包含两种或更多种连续媒体的文档，连续媒体也就是必须能够在某一时间间隔内回放的媒体。


- 有些模糊的术语是“视频”。在技术意义上，视频只是一部电影的图像部分（相对的是声音部分）。


- 然而，“数字视频”这一术语通常指的是完整的作品


- 后面我们将使用“电影”这一术语指完整的作品


- 非常短的电影，称为“视频剪辑”。

## 7.1 多媒体简介

- 在一台计算机上，多媒体通常意味着从数字通用光盘（Digital Versatile Disk，DVD）播放一段预先录好的电影。

  - 记录密度更高，容量在5GB到17GB之间（取决于记录格式）。
  - 一种光盘，
  - 它使用与CD-ROM相同的120 mm聚碳酸脂（塑料）盘片


- 成为DVD的后继者。
  - 一个是Blu-ray（蓝光）格式

  - 另一个是HD DVD格式


- 另一种多媒体的使用是从Internet上下载视频短片。许多


- 另一个必须支持多媒体的领域是视频本身的制作。


- 多媒体还在另一个领域中发挥着越来越重要的作用，这就是计算机游戏。
  - 计算机游戏经常要运行短暂的视频剪辑来描述某种活动。

  - 游戏本身也会生成大量的动画


- 多媒体世界的圣杯是视频点播（video on demand），

  - 多媒体世界的圣杯是视频点播（video on demand），这意味着消费者能够在家中使用电视遥控器（或鼠标）选择电影，并且立刻将其在电视机（或计算机显示器）上显示出来


- 视频点播要求有特殊的基础设施才能使用。


- 两种可能的视频点播基础设施

  - 每种都包含三个基本的组件：一个或多个视频服务器、一个分布式网络以及一个在每个房间中用来对信号进行解码的机顶盒。视频

  - 视频服务器（video server）是一台功能强大的计算机，在其文件系统中存放着许多电影，并且可以按照点播请求回放这些电影


- 大型机有时用来作为视频服务器


![7-1](H:\现代操作系统\resource\7-1.jpg)

- 用户和视频服务器之间的分布式网络必须能够高速实时地传输数据。这种

  - 设计十分有趣也十分复杂，


- 使用光纤从视频服务器连接到客户居住的居民点的汇接盒。ADSL系统是由电话公司经营的，在ADSL系统中，现有的双绞电话线提供了最后一公里的数据传输
- 有线电视是由有线电视公司经营的


- 有线电视电缆用于信号的本地分送。


- ADSL的优点
  - 有线电视使用高带宽的同轴电缆

  - 但是许多用户必须共享相同的电缆，


- 对于每个用户来说带宽没有保证


- 机顶盒（set-top box），这是ADSL或电视电缆终结的地方。
- 机顶盒实际上就是普通的计算机

  - 包含特殊的芯片用于视频解码和解压缩。


- 机顶盒的替代品是使用客户现有的PC机并且在显示器上显示电影。十分


- 技术角度看，使用个人计算机代替机顶盒更有道理，因为计算机的功能更加强大，拥有大容量的磁盘，拥有更高分辨率的显示器
- 多媒体所具有的两个关键特征：
  - 多媒体使用极高的数据率。 
  - 多媒体要求实时回放。


- 多媒体需要的数据率越高，则越需要进行压缩，并且需要的存储量也就越大。


![7-2](H:\现代操作系统\resource\7-2.jpg)

- 高数据率来自视觉与听觉信息的本性。


- 数字电影的视频部分每秒包含某一数目的帧。
  - 数字电影的视频部分每秒包含某一数目的帧。北美、南美和日本采用的NTSC制式每秒包含30帧（对纯粹主义者而言是29.97帧），世界上其他大部分地区采用的PAL和SECAM制式每秒包含25帧（对纯粹主义者而言是25.00帧）。帧必须分别以33.3ms或40ms的精确时间间隔传输


- NTSC代表美国国家电视标准委员会（National Television Standards Committee）


- PAL代表相位交错排列（Phase Alternating Line）

  - 它是技术上最好的制式。


- SECAM代表顺序与存储彩色（SEquentiel Couleur Avec Memoire），该制式被法国采用

  - 意在保护法国的电视制造商免受国外竞争


- 耳朵比眼睛更加敏感，
  - 传输率的变动称为颤动（jitter），必须严格限制颤动以获得良好


- 让人可以接受地回放多媒体所要求的实时性通常通过服务质量（quality of service）参数来描述，
  - 这些参数包括可用平均带宽、可用峰值带宽、最小和最大延迟（两者一起限制了颤动）以及位丢失概率


- 提供服务质量保证的最常见的方法是预先为每一个新到的客户预留容量，预留的资源包括CPU、内存缓冲区、磁盘传输容量以及网络带宽。


- 多媒体服务器需要有资源预留方案和进入控制算法（admission control algorithm），以判定什么时候能够处理更多的任务。

## 7.2 多媒体文件

- 在大多数系统中，普通的文本文件由字节的线性序列组成，


- 对于多媒体而言

  - 首先，视频与音频是完全不同的。它们由不同的设备捕获（视频为CCD芯片，音频为麦克风），具有不同的内部结构（视频每秒有25～30帧，音频每秒有44 100个样本），并且它们通过不同的设备来回放（视频为显示器，音频为扩音器）。


- 大多数好莱坞电影现在针对的是全世界的观众，而这些观众大多不讲英语。这


- 对于某些国家，需要产生一个额外的声音轨迹，用当地语言进行配音，但是不包含音效


- 在日本，所有的电视都具有两个声道，


- 在其他国家中，使用的是原始的声音轨迹，配以当地语言的字幕。


- 许多在电视中播放的电影现在也提供英文字幕，


- 结果，数字电影实际上可能由多个文件组成：一个视频文件、多个音频文件以及多个包含各种语言字幕的文本文件。


- DVD能够存放至多32种语言的字幕文件。
- 简单的一组多媒体文件如图7-3所示，我们将在本章后面解释快进和快退的含义


![7-3](H:\现代操作系统\resource\7-3.jpg)

- 文件系统需要跟踪每个文件的多个“子文件


- 一种可能的方案是像传统的文件一样管理每个子文件，并且要有一个新的数据结构列出每个多媒体文件的全部子文件。


- 另一方法是创造一种二维的i节点，使每一列列出每个子文件的全部块。


- 在各种情况下，还必须有保持子文件同步的某种方法，这样才能保证当选中的音频轨迹回放时与视频保持同步。

### 7.2.1 视频编码

- 人类的眼睛具有这样的特性：当一幅图像闪现在视网膜上时，在它衰退之前将保持几毫秒的时间


- 人类的眼睛具有这样的特性：当一幅图像闪现在视网膜上时，在它衰退之前将保持几毫秒的时间。如果一个图像序列以每秒50或更多张图像闪现，眼睛就不会注意到它看到的是不连续的图像


- 为了将二维图像表示为作为时间函数的一维电压，摄像机用一个电子束对图像进行横向扫描并缓慢地向下移动，记录下电子束经过处光的强度。在扫描的终点处，电子束折回，称为一帧（frame）


- 接收机则重复扫描过程以重构图像


- 摄像机与接收机采用的扫描模式如图7-4所示![7-4](H:\现代操作系统\resource\7-4.jpg)

![7-4](F:\现代操作系统\resource\7-4.jpg)

- 精确的扫描参数随国家的不同而有所不同。


- 精确的扫描参数随国家的不同而有所不同。NTSC有525条扫描线，水平与垂直方向的纵横比为4:3，每秒为30（实际为29.97）帧。欧洲的PAL和SECAM制式有625条扫描线，纵横比也是4:3，每秒为25帧。


- 精确的扫描参数随国家的不同而有所不同。NTSC有525条扫描线，水平


- 在两种制式中，顶端和底端的几条线是不显示


- 虽然每秒25帧足以捕获平滑的运动，但是在这样的帧率下，有许多人特别是老年人会感觉到图像闪烁


- 这一方法不是按从上到下的顺序显示扫描线，而是首先显示所有的奇数扫描线，接着再显示所有的偶数扫描线。此处的半帧称为一个场（field）


- 这一技术被称为隔行扫描（interlacing）。


- 非隔行扫描的电视或视频被称为逐行扫描（progressive）。黑白电视


- 彩色视频采用与单色（黑白）视频相同的扫描模式，只不过使用了三个同时运动的电子束而不是一个运动电子束来显示图像


- 为了在一个信道上进行传输，三个彩色信号必须组合成一个复合（composite）信号。


- 为了使黑白接收机可以显示传输的彩色电视节目，NTSC、PAL和SECAM三种制式均将RGB信号线性组合为一个亮度（luminance）信号和两个色度（chrominance）信号，


- 亮度信号应该用与旧的黑白信号相同的频率进行广播，从而使其可以被黑白电视机接收。两个色度信号则可


- 彩色视频，每一像素RGB三色中的每种颜色用8个二进制位来表示，这样可以表示224 ≈1600万种不同的颜色，


- 要产生平滑的运动效果，数字视频像模拟视频一样必须每秒至少显示25帧。


- 所有计算机显示器都采用逐行扫描


- 换言之，运动的平滑性是由每秒不同的图像数决定的，而闪烁则是由每秒刷新屏幕的次数决定的。


- 目前许多计算机显示器都采用4:3的纵横比，所以可以使用便宜的并且大量生产的显像管，这样的显像管本来是为电视市场的消费者设计的。显示器常用的配置有640×480（VGA）、800×600（SVGA）、1024×768（XGA）以及1600×1200（UXGA）。

### 7.2.2 音频编码 

- 音频（声音）波是一维的声（压）波。


- 人耳可以听到的声音的频率范围从20 Hz到20 000Hz，


- 音频波可以通过模数转换器（Analog Digital Converter，ADC）转换成数字形式。ADC以电压作为输入，并且生成二进制数作为输出。


- 如果一个声波不是纯粹的正弦波，而是正弦波的线性叠加，其中存在的最高频率成分为f ，那么2f的频率进行采样就足够了。贝尔实验室的一位物理学家Harry Nyquist从数学上证明了这一结果，这就是著名的Nyquist抽样定理。


- 由于每一样本的位数有限而引入的误差称为量化噪声（quantization noise）。如果量化噪声太大，耳朵就会感觉到。


- 对声音进行采样的两个著名的例子是电话和音频CD。


- 电话系统使用的是脉冲编码调制（pulse code modulation），脉冲编码调制每秒以7位（北美和日本）或8位（欧洲）对声音采样8000次


- 音频CD是以每秒44 100个样本的采样率进行数字化的，


- 音频压缩也许要以描述人类听觉如何工作的心理声学模型为基础。使用MPEG第3层（MP3）系统进行10倍的压缩是可能的。


- 数字化的声音可以十分容易地在计算机上用软件进行处理。

## 7.3 视频压缩

- 以非压缩格式处理多媒体信息是完全不可能的


- 所有的压缩系统都需要两个算法：一个用于在源端对数据进行压缩，另一个用于在目的端对数据进行解压缩，称为编码（encoding）算法和解码（decoding）算法，



- 这些算法具有某些不对称性，这一不对称性对于理解数据压缩是十分重要


- 首先，对于许多应用而言，一个多媒体文档（比如说一部电影）只需要编码一次（当该文档存储在多媒体服务器上时），但是需要解码数千次（当该文档被客户观看时）。


- 第二个不对称性是编码/解码过程不必是100%可逆的。


- 当解码输出不与原始输入严格相等时，系统被称为是有损的（lossy）

###7.3.1 视频压缩

- 用于压缩连续色调静止图像（例如照片）的JPEG（Joint Photographic Experts Group，联合摄影专家组）标准是由摄影专家在ITU、ISO和IEC等其他标准组织的支持下开发出来的。


- JPEG定义在10918号国际标准中。它具有4种模式和许多选项


- 用JPEG对一幅图像进行编码的第一步是块预制。


- 嘉禾JPEG输入一幅640×480的图像，每个像素24位，如图7-6a所示
- 从RGB值中计算出一个亮度信号和两个色度信号，对于NTSC制式，分别将其记作Y、I和Q，对于PAL制式，分别将其记作Y、U和V


- 对Y、I和Q构造不同的矩阵，每个矩阵其元素的取值范围在0到255之间。接下来，在I和Q矩阵中对由4个元素组成的方块进行平均，将矩阵缩小至320×240。


- 现在将所有三个矩阵的每个元素减去128，从而将0置于取值范围的中间。最后将每个矩阵划分成8×8的块，Y矩阵有4800块，其他两个矩阵每个有1200块，如图7-6b所示

![7-6](H:\现代操作系统\resource\7-6.jpg)

- JPEG的第2步是分别对7200块中的每一块应用DCT（离散余弦变换）。


- JPEG的第2步是分别对7200块中的每一块应用DCT（离散余弦变换）。每一DCT的输出是一个8×8的DCT系数矩阵


- DCT则是一种二维的空间傅立叶变换。


- DCT完成之后，JPEG进入到第3步，称为量化（quantization），在量化过程中不重要的DCT系数将被去除。


- T是无损的

![7-7](file:///C:/Users/木木/AppData/Local/Temp/calibre_jrjpet/ysbu_z_ebook_iter/images/00237.jpeg)

- DCT完成之后，JPEG进入到第3步，称为量化（quantization），在量化过程中不重要的DCT系数将被去除。这一（有损）变换是通过将8×8 DCT矩阵中的每个元素除以取自一张表中的权值而实现的。


- 量化表中的值不是JPEG标准的一部分。

![7-8](file:///C:/Users/木木/AppData/Local/Temp/calibre_jrjpet/ysbu_z_ebook_iter/images/00238.jpeg)
- 第4步通过将每一块的（0,0）值（左上角元素）以它与前一块中相应元素相差的量替换而减小。


- （0,0）值称为DC分量，其他值称为AC分量。


- 第5步是将64个元素线性化并且对线性化得到的列表进行行程长度编码。

![7-9](file:///C:/Users/木木/AppData/Local/Temp/calibre_jrjpet/ysbu_z_ebook_iter/images/00239.jpeg)

- 第6步将采用Huffman编码对列表中的数字进行编码以用于存储或传输。


- JPEG大体上是对称的：解码一幅图像花费的时间与编码基本相同。

### 7.3.2 MPEG标准 

- 最后，我们讨论问题的核心：MPEG（Motion Picture Experts Group，运动图像专家组）标准


- 这是用于压缩视频的主要算法


- MPEG的两个版本均利用了在电影中存在的两类冗余：空间冗余和时间冗余。空间冗余可以通过简单地用JPEG分别对每一帧进行编码而得到利用


- 互相连续的帧常常几乎是完全相同的，这就是时间冗余


- 数字便携式摄像机使用的数字视频（Digital Video，DV）系统只使用类JPEG的方案


- 对于摄像机和背景绝对静止，


- 对于摄像机和背景绝对静止，而有一两个演员在四周缓慢移动的场景而言


- 仅仅将每一帧减去前一帧并且在差值图像上运行JPEG就相当不错


- 对于摇动或缩放摄像机镜头的场景而言，需要某种方法对这一运动进行补偿，这正是MPEG要做的事情；


- 这就是MPEG和JPEG之间的主要差别。


- MPEG-2输出由三种不同的帧组成，观看程序必须对它们进行处理，这三种帧为：

  - I帧：自包含的JPEG编码静止图像。 
  - P帧：与上一帧逐块的差。 
  - B帧：与上一帧和下一帧


- I帧只是用JPEG编码的静止图像


- 在输出流中使I帧周期性地出现是十分必要的
- 其原因有三。

  - 首先，MPEG可以用于电视广播，而观众收看是随意的。如果

  - 第二，如果任何一帧在接收时出现错误，那么进一步的解码就不可能再进行。

  - 第三，没有I帧，在进行快进或倒带时，解码器将不得不计算经过的每一帧，只有这样才能知道快进或倒带停止时帧的全部值。


- MPEG每秒将I帧插入到输出中一次或两次。


- P帧基于宏块（macroblock）的思想，宏块覆盖亮度空间中16×16个像素和色度空间中8×8个像素。


- P帧基于宏块（macroblock）的思想


- 通过在前一帧中搜索宏块或者与其只存在轻微差异的宏块实现对一个宏块的编码。


- 包含背景的宏块是严格匹配的，但是包含人的宏块在位置上存在某一未知数量的偏移，编码时必须追踪到前一帧中相应的宏块。


- MPEG标准没有规定如何搜索、搜索多远以及如何计算一个匹配的好坏，这些都留给每一具体的实现。


- 输出流中宏块的值是运动矢量（宏块在每一方向从其前一位置移动多远的距离），随后是以JPEG进行编码的与前一帧的差值。


- B帧与P帧相类似，不同的是它允许参考宏块既可以在前一帧中，也可以在后续的帧中，既可以在I帧中，也可以在P帧中。


- 这一额外的自由可以改进运动补偿，并且在物体从前面（或后面）经过其他物体时非常有用。例如


- 要进行B帧编码，编码器需要在内存中同时保存三个解码的帧：过去的一帧、当前的一帧和未来的一帧。为了简化解码，各帧必须以依赖的顺序而不是以显示的顺序出现在MPEG流中。因而，当一段视频通过网络被观看时，即使有完美的定时，在用户的机器上也需要进行缓冲，对帧进行记


- 要进行B帧编码，编码器需要在内存中同时保存三个解码的帧：过去的一帧、当前的一帧和未来的一帧。


- 当一段视频通过网络被观看时，即使有完美的定时，在用户的机器上也需要进行缓冲，对帧进行记录以便正常地显示。


- 有许多动作以及快速剪切（比如战争电影）的电影需要许多I型帧。

## 7.4 音频压缩

- CD品质的音频需要一个1.411 Mbps带宽的传送。


- 最流行的算法是拥有三个层（变体）的MPEG音频，其中，MP3(MPEG音频层3)是功能最强大也是最出名的。


- MP3属于MPEG视频压缩标准里的音频部分。


- 因此引发了许多来自艺术家与版权拥有者的案件


- 音频压缩可以用两种方法完成


- 在波形编码技术中，信号通过傅立叶变换（Fourier transform）变换成频率分量。


- 音频压缩可以用两种方法完成
  - 在波形编码技术中，信号通过傅里叶变换变化成频率分量。然后每一个分量的振幅用最简短的方法编码。目标是在另一端用尽可能少的二进制位精确地重建其波形。图7-11给出一个时间与它最初的15个傅立叶振幅的实例函数
  - 另一种方法是感知编码，这种技术是在人类听觉系统中寻找某种细纹，用来对信号编码，


![](file:///C:/Users/木木/AppData/Local/Temp/calibre_mzjkxk/pxf3dl_ebook_iter/images/00241.jpeg)

- 感知编码是基于心理声学的——人们如何感知声音的科学。MP3正是基于感知编码。


- 感知编码的关键特性在于一些声音可以掩盖住其他声音。


- 这种技术就叫做频段屏蔽——在一个频段里响亮的声音掩盖住另一频段中较柔和声音的能力，


- 即使风镐停止工作，在一个短时间内笛子的声音也很难再被听到，这种效果称为暂时屏蔽。


- 人们并没有必要对那些功率在可听阈值之下的频率编码。


- 通过跟踪那些被附近频段能量更强的信号所屏蔽的信号，可以省略越来越多的编码信号中的频率，以此来节约二进制位。


- MP3编码的实质就是对声音做傅立叶变换从而得到每个频率的能量，之后只传递那些不被屏蔽掉的频率，并且用尽可能少的二进制位数来编码这些频率。


- 编码是如何完成的。


- 通过抽取32kHz、44.1kHz或者48 kHz的波形，完成声音压缩


- 可以在以下四个配置中任选一个，用一或两个通道完成抽样：、
  - 单声道（一个输入流）。 
  - 双声道（例如，一个英语的和一个日语的音轨）。 
  - 分立立体声（每个通道分开压缩）。 
  - 联合立体声（完全利用通道间的冗余）。


- 首先，选择输出的比特率。

  - 摇滚的信噪比要比一场钢琴音乐会要高得多（至少从工程角度上看）
  - 一场钢琴音乐会，至少需要128kbps

  - MP3可以将摇滚CD的立体声降低到96kbps


- 然后将这些样本处理成1152（大概26ms）的一些组，每组首先通过32个数字滤波器，获得32个频率波段
  - 进一步转换32频率波段中的每一个，以提供一个更精确的频谱解决方案。


- 接着，将现有的二进制位分配到各个波段中，大部分二进制位分配给拥有多数频谱能量的未屏蔽波段，小部分二进制位分配给拥有较少频谱能量的未屏蔽波段，已屏蔽的波段不分配二进制位。最后，用霍夫曼编码来对这些二进制位进行编码，它可以将经常出现的数字赋予较短的代码，而对不常出现的数字赋予较长的代码。


- 实际的工作过程更复杂。

## 7.5 多媒体进程调度

- 支持多媒体的操作系统与传统的操作系统在三个主要的方面有所区别：进程调度、文件系统和磁盘调度。

### 7.5.1 调度同质进程 

- 最简单的一种视频服务器可以支持显示固定数目的电影，所有电影使用相同的帧率、视频分辨率、数据率以及其他参数。


- 对每一部电影，存在一个进程（或线程），其工作是每次从磁盘中读取电影的一帧然后将该帧传送给用户。


- 采用轮转调度


- 定时机制，以确保每一进程以恰当的频率运行。


- 方式是有一个主控时钟，该时钟每秒滴答适当的次数，例如针对NTSC

### 7.5.2 一般实时调度

- 相同的进程可能必须以不同的频率运行，具有不同的工作量，并且具有不同的最终时限（在


- 多个进程竞争CPU，每个进程有自己的工作量和最终时限。


- 一个不同的模型：多个进程竞争CPU，每个进程有自己的工作量和最终时限。


- 多个相互竞争的进程，其中若干进程或全部进程具有必须满足的最终时限的调度称为实时调度（real-time scheduling）。


- 作为实时多媒体调度程序工作环境的一个例子，我们考虑三个进程A、B和C，如图7-13所示。

![](file:///C:/Users/木木/AppData/Local/Temp/calibre_mzjkxk/pxf3dl_ebook_iter/images/00243.jpeg)

- 现在调度问题是如何调度A、B和C以确保它们满足各自的最终时限


- 每个CPU突发处理一帧并且具有一个最终时限：它必须在下一个突发开始之前完成。


- 在不存在竞争的情况下，进程A将在突发A1、A2、A3等中运行，每一突发在前一突发的30ms之后开始。每个CPU突发处理一帧并且具有一个最终时限：它必须在下一个突发开始之前完成。


- 如果进程i具有Pi ms的周期并且需要Ci ms的CPU时间，那么系统是可调度的当且仅当 其中m是进程数，在本例中，m=3。注意，Ci /Pi 只是CPU被进程i使用的部分。


- 该系统是可调度的。


- 实际上，每个影片流可能有两个（或更多个）进程，


- 某些实时系统中，进程是可抢占的，在其他的系统中，进程是不可抢占的。


- 实际上，每个影片流可能有两个（或更多个）进程，例如，一个用于音频，一个用于视频。


- 在某些实时系统中，进程是可抢占的，在其他的系统中，进程是不可抢占的。在多媒体系统中，进程通常是可抢占的，这意味着允许有危险错过其最终时限的进程在正在运行的进程完成工作以前将其中断，然后当它完成工作之后，被中断的前一个进程再继续运行


- 实时算法可以是静态的也可以是动态的。


- 静态算法预先分配给每个进程一个固定的优先级，然后使用这些优先级做基于优先级的抢占调度。动态算法


- 动态算法没有固定的优先级。

### 7.5.3 速率单调调度 

- 适用于可抢占的周期性进程的经典静态实时调度算法是速率单调调度（Rate Monotonic Scheduling，RMS）


- 它可以用于满足下列条件的进程： 
  - 每个周期性进程必须在其周期内完成。 
  - 没有进程依赖于任何其他进程。 
  - 每一进程在一次突发中需要相同的CPU时间量。 
  - 任何非周期性进程都没有最终时限。 
  - 进程抢占即刻发生而没有系统开销。


- 前四个条件是合理的。当然，最后一个不是，但是该条件使系统建模更加容易。
- RMS分配给每个进程一个固定的优先级，优先级等于进程触发事件发生的频率。例如

- 优先级与进程的速率（每秒运行进程的次数）成线性关系，

- 速率单调的原因
### 7.5.4　最早最终时限优先调度

另一个流行的实时调度算法是最早最终时限优先（Earliest Deadline First，EDF）算法。EDF是一个动态算法，
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9177-9178的标注 | 添加于 2019年4月4日星期四 下午9:36:54

调度程序维持一个可运行进程的列表，该列表按最终时限排序。
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9186-9187的标注 | 添加于 2019年4月5日星期五 上午12:23:07

可调度性测试计算CPU的利用率为0.500+0.375+0.100=0.975。CPU
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9184-9185的标注 | 添加于 2019年4月5日星期五 上午12:23:24

为了消除RMS和EDF总是给出相同结果的想法，现在让我们看一看另外一个例子，如图7-15所示。
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9177-9179的标注 | 添加于 2019年4月5日星期五 上午12:32:11

调度程序维持一个可运行进程的列表，该列表按最终时限排序。EDF算法运行列表中的第一个进程，也就是具有最近最终时限的进程
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9177-9179的标注 | 添加于 2019年4月5日星期五 上午12:32:13

图7-14给出了EDF的一个例子。
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9198-9198的标注 | 添加于 2019年4月5日星期五 上午12:39:28

一个有趣的问题是RMS为什么会失败。根本上，使用静态优先级只有在CPU的利用率不太高的时候才能工作。
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9199-9200的标注 | 添加于 2019年4月5日星期五 上午12:39:56

任何周期性进程系统，如果 那么就可以保证RMS工作。
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9204-9205的标注 | 添加于 2019年4月7日星期日 下午5:33:08

与此相对照，EDF对于任意一组可调度的进程总是可以工作的，它可以达到100%的CPU利用率，付出的代价是更为复杂的算法。因而
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9204-9205的标注 | 添加于 2019年4月7日星期日 下午5:33:14

与此相对照，EDF对于任意一组可调度的进程总是可以工作的，它可以达到100%的CPU利用率，付出的代价是更为复杂的算法
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9201-9202的标注 | 添加于 2019年4月7日星期日 下午5:33:47

对于三个进程，如果CPU利用率等于或小于0.780，那么RMS总是可以工作的。
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9211-9213的标注 | 添加于 2019年4月7日星期日 下午6:30:44

的。进程要访问一个文件时，首先要发出open系统调用。如果该调用成功，则调用者被给予某种令牌以便在未来的调用中使用，该令牌在UNIX中被称为文件描述符，在Windows中被称为句柄
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9210-9210的标注 | 添加于 2019年4月7日星期日 下午8:11:57
## 7.6 多媒体文件系统范型
多媒体文件系统
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9210-9210的标注 | 添加于 2019年4月7日星期日 下午8:12:02

使用了与传统文件系统不同的范型。
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9213-9213的标注 | 添加于 2019年4月7日星期日 下午8:12:12

进程可以发出read系统调用
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9214-9215的标注 | 添加于 2019年4月7日星期日 下午8:12:24

在进程结束时它将调用close以关闭文件并返回其资源。
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9215-9216的标注 | 添加于 2019年4月7日星期日 下午8:13:28

在显示来自远程视频服务器的多媒体文件时，该模型的工作尤为拙劣
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9215-9215的标注 | 添加于 2019年4月7日星期日 下午8:13:41

由于实时行为的需要，这一模型对于多媒体并不能很好地工作
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9216-9217的标注 | 添加于 2019年4月7日星期日 下午8:13:56

第一个问题是用户必须以相当精确的时间间隔进行read调用。第二个问题是视频服务器必须能够没有延迟地提供数据块，
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9218-9219的标注 | 添加于 2019年4月7日星期日 下午8:14:16

为解决这些问题，多媒体文件服务器使用了一个完全不同的范型：像录像机（Video Cassette Recorder，VCR）一样工作
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9219-9220的标注 | 添加于 2019年4月7日星期日 下午8:14:32

用户进程发出start系统调用，指定要读的文件和各种其他参数
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9219-9220的标注 | 添加于 2019年4月7日星期日 下午8:14:35

视频服务器开始以必要的速率送出帧。
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9220-9222的标注 | 添加于 2019年4月7日星期日 下午8:15:21

视频服务器开始以必要的速率送出帧。然后用户进程以帧进来的速率对它们进行处理。如果用户对所看的电影感到厌烦，那么发出stop系统调用可以将数据流终止
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9222-9222的标注 | 添加于 2019年4月7日星期日 下午8:15:29

拉取型服务器（pull server），用户不得不通过重复地调用read一块接一块地取得数据，每调用一次可以拉取出一块数据
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9222-9224的标注 | 添加于 2019年4月7日星期日 下午8:15:59

推送型服务器（push server），因为它将数据推送给用户；与此相对照的是传统的拉取型服务器（pull server），用户不得不通过重复地调用read一块接一块地取得数据，每调用一次可以拉取出一块数据。这两个模型之间的区别如图7-16所
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9222-9224的标注 | 添加于 2019年4月7日星期日 下午8:16:16

### 7.6.1　VCR控制功能 
大多数视频服务器也实现了标准的VCR控制功能，包括暂停、快进和倒带。
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9226-9227的标注 | 添加于 2019年4月8日星期一 上午10:56:33

暂停是相当简单的。
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9227-9228的标注 | 添加于 2019年4月8日星期一 上午10:56:49

。视频服务器此时要做的全部事情是记住下一次要送出的是哪一帧。
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9229-9230的标注 | 添加于 2019年4月8日星期一 下午3:28:33

为了获得可接受的性能，服务器应该为每个流出的数据流保留诸如磁盘带宽和内存缓冲区等资源。
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9233-9233的标注 | 添加于 2019年4月8日星期一 下午3:29:02

真正的倒带实际上非常简单，没有任何复杂性。
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9233-9234的标注 | 添加于 2019年4月8日星期一 下午3:29:40

真正的倒带实际上非常简单，没有任何复杂性。服务器要做的全部事情是注意到下一次要送出的帧是第0帧。
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9238-9238的标注 | 添加于 2019年4月8日星期一 下午3:30:00

压缩则使快进和快倒复杂起来。
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9242-9242的标注 | 添加于 2019年4月8日星期一 下午3:30:40

对一个DV文件进行
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9242-9243的标注 | 添加于 2019年4月8日星期一 下午3:30:49

对一个DV文件进行快进操作需要有一个索引，该索引可以使帧的查找快速地实现，但是
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9243-9244的标注 | 添加于 2019年4月8日星期一 下午3:31:35

对于MPEG，由于使用I帧、P帧和B帧，这一方案即使在理论上也是不能工作的。向前
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9246-9247的标注 | 添加于 2019年4月8日星期一 下午3:32:36

攻克这一难题的另一个方法是实际尝试以10倍的速度顺序地播放文件
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9248-9249的标注 | 添加于 2019年4月8日星期一 下午3:33:29

这样做给服务器增加了沉重的负担。这一方法还要求服务器了解压缩格式
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9249-9250的标注 | 添加于 2019年4月8日星期一 下午3:33:54

作为替代，可以通过网络实际发送所有的数据给用户，并在用户端选出正确的帧，这样做就要求网络以10倍的速度运行，
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9252-9253的标注 | 添加于 2019年4月8日星期一 下午3:34:15

惟一可行的策略要求预先规划。可以做的事情是建立一个特殊的文件，包含每隔10帧中的一帧，并且将该文件以通常的MPEG算法进行压缩
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9257-9257的标注 | 添加于 2019年4月8日星期一 下午3:35:02

当用户切换回到正常速度时，必须使用相反的技巧
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9259-9261的标注 | 添加于 2019年4月8日星期一 下午3:35:54

，这一方案还是有某些缺点。首先，需要某些额外的磁盘空间来存放额外的文件。其次，快进和倒带只能以对应于特别文件的速度进行。第三，在常规文件、快进文件和快倒文件之间来回切换需要额外的复杂算法。
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9264-9265的标注 | 添加于 2019年4月8日星期一 下午3:36:20

### 7.6.2　近似视频点播 
有k个用户取得相同的电影和这些用户取得k部不同的电影在本质上给服务器施加了相同的工作量。
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9268-9268的标注 | 添加于 2019年4月8日星期一 下午3:37:14

使优化成为可能的修改是，通知所有用户电影只在整点和随后每隔（例如）5分钟开始。
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9272-9273的标注 | 添加于 2019年4月8日星期一 下午3:37:58

这一方案称为近似视频点播（near video on demand），
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9272-9273的标注 | 添加于 2019年4月8日星期一 下午3:38:10

这一方案称为近似视频点播（near video on demand），因为视频并不是完全随着点播而开始，而是在点播之后不久开始。
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9275-9276的标注 | 添加于 2019年4月8日星期一 下午3:39:15

这里的关键参数是多长时间开始一个数据流。
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9278-9279的标注 | 添加于 2019年4月8日星期一 下午3:39:34

一个替代的策略是同时提供不用等待的选择权，在这种情况下，新的数据流可以立刻开始，但是需要对系统做更多的修改以支持即时启动。
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9284-9285的标注 | 添加于 2019年4月8日星期一 下午3:40:41

对于近似视频点播，用户不具有VCR控制能力。
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9286-9287的标注 | 添加于 2019年4月8日星期一 下午3:40:57

实际上，近似视频点播还有另外一个模型。
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9286-9287的标注 | 添加于 2019年4月8日星期一 下午3:41:09

实际上，近似视频点播还有另外一个模型。在这个模型中，人们可以在他们需要的任意时候预订电影
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9295-9297的标注 | 添加于 2019年4月8日星期一 下午3:42:58

### 7.6.3　具有VCR功能的近似视频点播 
将近似视频点播（为的是效率）加上每个个体观众完全的VCR控制（为的是方便用户）是一种理想的组合
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9299-9300的标注 | 添加于 2019年4月8日星期一 下午3:49:44

要求每个客户机在本地缓冲前∆T分钟以及即将来临的∆T分钟。
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9306-9307的标注 | 添加于 2019年4月8日星期一 下午3:51:37

当前被显示的帧称为播放点（play point），它总是处于缓冲区的中间点。
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9313-9314的标注 | 添加于 2019年4月8日星期一 下午4:16:49

，如果播放点在某个方向离开了这一区间，我们就遇到了问题。解决方法是开启一个私有（也就是视频点播）数据流以服务于用户
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9314-9316的标注 | 添加于 2019年4月8日星期一 下午4:17:09

在某一时刻用户可能会安下心来决定再次以正常速度观看电影。此时，我们可以考虑将用户迁移到某一近似视频点播数据流，这样私有数据流就可以被放弃
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9318-9319的标注 | 添加于 2019年4月8日星期一 下午4:17:19

解决方法是继续观看私有数据流，但是开始从当前正播放电影第15分钟那一帧的数据流填充缓冲区。
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9316-9317的标注 | 添加于 2019年4月8日星期一 下午4:17:46

假设用户决定返回到12分钟标号处，如图7-18b所示。这一点远远超出了缓冲区的范围，所以显示不可能从缓冲区馈入。此外
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9318-9319的标注 | 添加于 2019年4月8日星期一 下午4:18:19

解决方法是继续观看私有数据流，但是开始从当前正播放电影第15分钟那一帧的数据流填充缓冲区。
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9318-9321的标注 | 添加于 2019年4月8日星期一 下午4:18:38

解决方法是继续观看私有数据流，但是开始从当前正播放电影第15分钟那一帧的数据流填充缓冲区。经过3分钟之后的情形如图7-18c所示。播放点现在是第15分钟，缓冲区包含了15到18分钟的帧，而近似视频点播数据流正处在第8、13、18和23分钟。在
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9318-9321的标注 | 添加于 2019年4月8日星期一 下午4:18:40

解决方法是继续观看私有数据流，但是开始从当前正播放电影第15分钟那一帧的数据流填充缓冲区。经过3分钟之后的情形如图7-18c所示。播放点现在是第15分钟，缓冲区包含了15到18分钟的帧，而近似视频点播数据流正处在第8、13、18和23分钟。在
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9318-9321的标注 | 添加于 2019年4月8日星期一 下午4:18:52

解决方法是继续观看私有数据流，但是开始从当前正播放电影第15分钟那一帧的数据流填充缓冲区。经过3分钟之后的情形如图7-18c所示。播放点现在是第15分钟，缓冲区包含了15到18分钟的帧，而近似视频点播数据流正处在第8、13、18和23分钟。在
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9322-9323的标注 | 添加于 2019年4月8日星期一 下午4:19:31

经过另一分钟之后，播放点是第16分钟，缓冲区包含了15到19分钟的帧，并且数据流在第19分钟处将数据馈入缓冲区，如图7-18d所示。
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9323-9323的标注 | 添加于 2019年4月8日星期一 下午4:19:48

经过另外6分钟之后，缓冲区变满，并且播放点是在第22分钟。
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9327-9328的标注 | 添加于 2019年4月8日星期一 下午4:20:14

## 7.7 文件存放

多媒体文件非常庞大，通常只写一次而读许多次，并且倾向于被顺序访问。它们的回放还必须满足严格的服务质量标准。
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9330-9330的标注 | 添加于 2019年4月8日星期一 下午4:20:31

### 7.7.1　在单个磁盘上存放文件

在视频服务器上消除文件内寻道的一种方法是使用连续的文件。通常，使文件为连续的工作做得并不十分好，但是在预先精心装载了电影的视频服务器上它工作得还是不错的
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9334-9334的标注 | 添加于 2019年4月8日星期一 下午4:24:11

然而，视频、音频和文本的存在是一个复杂因素，
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9336-9336的标注 | 添加于 2019年4月8日星期一 下午4:24:33

第二种可能的存储排列，使视频、音频和文本交叉存放，但是整个文件还是连续的，
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9336-9336的标注 | 添加于 2019年4月8日星期一 下午4:24:52

这一组织需要额外的磁盘I/O读入不必要的音频和文本，在内存中还需要额外的缓冲区空间存放它们
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9342-9343的标注 | 添加于 2019年4月8日星期一 下午4:30:57

随机访问是不可能的
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9343-9344的标注 | 添加于 2019年4月8日星期一 下午4:31:02

快进和快倒也是不可能的。
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9343-9344的标注 | 添加于 2019年4月8日星期一 下午4:31:07

如果没有额外的数据结构和复杂性，快进和快倒也是不可能的。
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9346-9347的标注 | 添加于 2019年4月8日星期一 下午4:31:55

对于一部电影既可以读也可以写的系统（例如用于视频生产或编辑的系统）来说，使用巨大的连续文件是很困难的，因而也是没有用的。
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9344-9345的标注 | 添加于 2019年4月8日星期一 下午4:32:41

在具有多个并发输出流的视频服务器上，使整部电影成为一个连续文件的优点就失去了，
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9350-9350的标注 | 添加于 2019年4月8日星期一 下午4:32:56

### 7.7.2　两个替代的文件组织策略


小块模型，如图7-20a所示。
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9353-9354的标注 | 添加于 2019年4月8日星期一 下午4:44:21

这里的思想是每部电影有一个帧索引，这是一个数据结构，每一帧有一个帧索引项，指向帧的开始。每一帧本身是一连串连续的块，包含该帧所有的视频、音频和文本轨迹，如图7-20中所
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9353-9354的标注 | 添加于 2019年4月8日星期一 下午6:16:53

这里的思想是每部电影有一个帧索引，这是一个数据结构，每一帧有一个帧索引项，指向帧的开始。每一帧本身是一连串连续的块，包含该帧所有的视频、音频和文本轨迹，如图7-20中所示。
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9357-9358的标注 | 添加于 2019年4月8日星期一 下午6:28:32

存放电影的另一个方法是使用大磁盘块（比如256KB），并且在每一块中放入多个帧，如图7-20b所示。这里
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9357-9359的标注 | 添加于 2019年4月8日星期一 下午6:29:07

存放电影的另一个方法是使用大磁盘块（比如256KB），并且在每一块中放入多个帧，如图7-20b所示。这里仍然需要一个索引，但是这次不是帧索引而是块索引。实际
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9357-9359的标注 | 添加于 2019年4月8日星期一 下午6:29:12

存放电影的另一个方法是使用大磁盘块（比如256KB），并且在每一块中放入多个帧，如图7-20b所示。这里仍然需要一个索引，但是这次不是帧索引而是块索引。实际
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9357-9359的标注 | 添加于 2019年4月8日星期一 下午6:29:17

存放电影的另一个方法是使用大磁盘块（比如256KB），并且在每一块中放入多个帧，如图7-20b所示。这里仍然需要一个索引，但是这次不是帧索引而是块索引
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9360-9361的标注 | 添加于 2019年4月8日星期一 下午6:29:41

一个磁盘块拥有的帧的数目不见得是整数，所以需要做某些机制来处理这一问题。解决这一问题有两种选择。
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9363-9364的标注 | 添加于 2019年4月8日星期一 下午6:32:03

第一种选择如图7-20b所示，当下一帧填不满当前磁盘块的时候，则磁盘块剩余的部分就保持空闲状态。
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9365-9366的标注 | 添加于 2019年4月8日星期一 下午6:32:13

另一种选择是填充每一磁盘块到尽头，将帧分裂开使其跨越磁盘块。
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9367-9368的标注 | 添加于 2019年4月8日星期一 下午6:33:06

图7-20a中小块的使用也会浪费某些磁盘空间，因为在每一帧的最后一块可能有一小部分未被使用
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9370-9370的标注 | 添加于 2019年4月8日星期一 下午6:35:22

另一方面，块索引比帧索引
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9370-9370的标注 | 添加于 2019年4月8日星期一 下午6:35:28

另一方面，块索引比帧索引要小很多
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9375-9375的标注 | 添加于 2019年4月8日星期一 下午6:35:36

当电影在播放时，块索引比帧索引节省了接近1MB的RAM空间。
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9375-9378的标注 | 添加于 2019年4月8日星期一 下午6:35:54

这些考虑导出了如下的权衡： 1)帧索引：电影在播放时使用大量的RAM；磁盘浪费小。 2)块索引（禁止分裂帧跨越磁盘块）：RAM用量低；磁盘浪费较大。 3)块索引（允许分裂帧跨越磁盘块）：RAM用量低；无磁盘浪费；需要额外寻道。
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9380-9381的标注 | 添加于 2019年4月8日星期一 下午6:37:33

。采用分页操作在需要的时候及时将帧索引装入内存，可以减少RAM的使用量。通过足够的缓冲可以屏蔽在帧传输过程中的寻道，但是这需要额外的内存并且可能还需要额外的复制操作。
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9378-9379的标注 | 添加于 2019年4月8日星期一 下午6:37:49

这里的权衡涉及回放时RAM的使用量、自始至终浪费的磁盘空间以及由于额外寻道造成的回放时的性能损失。
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9379-9381的标注 | 添加于 2019年4月8日星期一 下午6:37:56

这些问题可以用各种方法来解决。采用分页操作在需要的时候及时将帧索引装入内存，可以减少RAM的使用量。通过足够的缓冲可以屏蔽在帧传输过程中的寻道，但是这需要额外的内存并且可能还需要额外的复制操作。
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9382-9383的标注 | 添加于 2019年4月8日星期一 下午6:50:13

这里的另一个因素是图7-20a中的磁盘存储管理更加复杂，因为存放一帧需要找到大小合适的一连串连续的磁盘块。
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9384-9385的标注 | 添加于 2019年4月8日星期一 下午6:50:55

这些要求意味着，磁盘的自由存储空间必须组织成变长孔洞的列表，而不是简单的块列表或者位图
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9386-9387的标注 | 添加于 2019年4月8日星期一 下午6:51:43

还要说明的是，只要可能应该把一部电影的所有块或者帧放置在一个狭窄的范围之内，比如说几个柱面。
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9388-9389的标注 | 添加于 2019年4月8日星期一 下午6:51:53

这种受约束的存放可以通过将磁盘划分成柱面组来实现，每个组保持单独的空闲块列表或位图。
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9391-9391的标注 | 添加于 2019年4月8日星期一 下午6:52:11

这两种方法之间的另一个区别是缓冲
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9391-9392的标注 | 添加于 2019年4月8日星期一 下午6:52:21

这两种方法之间的另一个区别是缓冲。对于小块方法，每次读操作正好读取一帧
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9391-9392的标注 | 添加于 2019年4月8日星期一 下午6:53:12

这两种方法之间的另一个区别是缓冲。对于小块方法，每次读操作正好读取一帧。因此，采用简单的双缓冲策略就工作得相当好：一个缓冲区用于回放当前帧，另一个用于提取下一帧
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9395-9395的标注 | 添加于 2019年4月8日星期一 下午6:54:53

使用大磁盘块时
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9395-9396的标注 | 添加于 2019年4月8日星期一 下午6:55:23

使用大磁盘块时，因为每一块包含多个帧，并且在每一块的尽头还可能包含帧的片段（取决于选定前面提到的是哪种选择），因而需要更加复杂的
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9395-9396的标注 | 添加于 2019年4月8日星期一 下午6:55:25

使用大磁盘块时，因为每一块包含多个帧，并且在每一块的尽头还可能包含帧的片段（取决于选定前面提到的是哪种选择），因而需要更加复杂的策略。
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9398-9399的标注 | 添加于 2019年4月8日星期一 下午6:58:01

双缓冲也可以用于大磁盘块，但是使用两个大磁盘块会浪费内存
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9398-9400的标注 | 添加于 2019年4月8日星期一 下午6:59:27

双缓冲也可以用于大磁盘块，但是使用两个大磁盘块会浪费内存。解决浪费内存问题的一种方法是使用比为网络或显示器提供数据的磁盘块（每个数据流）稍大一些的循环传输缓冲区。
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9403-9403的标注 | 添加于 2019年4月8日星期一 下午7:00:03

在比较这两种方法时，还有另一个因素就是磁盘性能。使用
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9403-9403的标注 | 添加于 2019年4月8日星期一 下午7:00:10

在比较这两种方法时，还有另一个因素就是磁盘性能
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9403-9404的标注 | 添加于 2019年4月8日星期一 下午7:02:10

在比较这两种方法时，还有另一个因素就是磁盘性能。使用大磁盘块时磁盘可以以全速运转，这经常是主要关心的事情。
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9406-9407的标注 | 添加于 2019年4月8日星期一 下午7:02:29

图7-20a的小块组织有时称为恒定时间长度（constant time length），因为索引中的每个指针代表着相同的播放时间毫秒数。
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9407-9407的标注 | 添加于 2019年4月8日星期一 下午7:02:53

，图7-20b的组织有时称为恒定数据长度（constant data length），因为数据块的大小相同。
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9408-9409的标注 | 添加于 2019年4月8日星期一 下午7:54:53

两种文件组织间的另一个区别是，如果帧的类型存储在图7-20a的索引中，那么有可能通过仅仅显示I帧实现快进。
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9411-9411的标注 | 添加于 2019年4月8日星期一 下午7:55:02

第二种方法是使用一个特殊
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9411-9412的标注 | 添加于 2019年4月8日星期一 下午7:55:11

第二种方法是使用一个特殊的文件给人以10倍速度快进的感觉，而这个特殊的文件是以正常速度播放的。
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9416-9416的标注 | 添加于 2019年4月8日星期一 下午7:58:11

如果使用了帧索引，那么定位一个特定的帧是十分容易的，只要检索帧索引即可
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9416-9418的标注 | 添加于 2019年4月8日星期一 下午7:58:19

如果使用了帧索引，那么定位一个特定的帧是十分容易的，只要检索帧索引即可。如果使用的是块索引，那么每个索引项中需要有额外的信息以识别哪一帧在哪一块中，并且必须对块索引执行二分搜索。快
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9421-9421的标注 | 添加于 2019年4月8日星期一 下午7:59:49

### 7.7.3　近似视频点播的文件存放

近似视频点播将同一部电影作为多个交错的数据流送出。即使电影是作为连续文件存放的，每个数据流也需要进行寻道。Chen
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9422-9424的标注 | 添加于 2019年4月8日星期一 下午8:04:06

近似视频点播将同一部电影作为多个交错的数据流送出。即使电影是作为连续文件存放的，每个数据流也需要进行寻道。Chen和Thapar（1997）设计了一种文件存放策略几乎可以消除全部这样的寻道。
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9427-9428的标注 | 添加于 2019年4月8日星期一 下午8:04:15

在这一存放策略中，由24个帧组成的帧集合连成一串并且作为一个记录写入磁盘
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9432-9433的标注 | 添加于 2019年4月8日星期一 下午8:05:16

这一方法不要求整个文件是连续的，但是对于若干个同时的数据流仍然给予了良好的性能。
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9433-9434的标注 | 添加于 2019年4月8日星期一 下午8:05:28

简单的缓冲策略是使用双缓冲。
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9435-9436的标注 | 添加于 2019年4月8日星期一 下午8:05:41

一个有趣的问题是构造多大的缓冲区。
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9438-9439的标注 | 添加于 2019年4月8日星期一 下午8:07:05

幸运的是，对于任何一部给定的电影，电影中最大的磁道（在图7-21的意义上说）事先是已知的，所以可以选择缓冲区恰好为这一大小。
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9440-9440的标注 | 添加于 2019年4月8日星期一 下午8:07:45

。选择缓冲区的大小能够足以装下第二大的磁道可能更为明智
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9442-9443的标注 | 添加于 2019年4月8日星期一 下午8:08:08

进一步运用这一方法，如果第三大的磁道只有4个I帧，使用能够保存4个I帧和20个P帧的缓冲区是值得的。
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9448-9448的标注 | 添加于 2019年4月8日星期一 下午8:08:25

### 7.7.4　在单个磁盘上存放多个文件


通过观察到某些电影比其他电影更为流行并且在磁盘上存放电影时将流行性考虑进去，可以改进这一情况
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9449-9450的标注 | 添加于 2019年4月8日星期一 下午8:09:10

在视频服务器上，当然存在着许多电影。如果它们随机地散布在磁盘上，那么当多部电影被不同的客户同时观看
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9450-9450的标注 | 添加于 2019年4月8日星期一 下午8:09:15

当多部电影被不同的客户同时观看时，时间将浪费在磁头在电影之间来回移动上。
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9453-9453的标注 | 添加于 2019年4月8日星期一 下午8:09:51

对于许多种类的流行
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9453-9453的标注 | 添加于 2019年4月8日星期一 下午8:09:54

对于许多种类的流行
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9454-9455的标注 | 添加于 2019年4月8日星期一 下午8:10:03

相对流行性的一个合理的近似遵循着一种令人惊奇的可预测模式。
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9453-9453的标注 | 添加于 2019年4月8日星期一 下午8:10:15

对于许多种类的流行性比赛，
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9456-9456的标注 | 添加于 2019年4月8日星期一 下午8:10:28

Zipf定律。
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9456-9457的标注 | 添加于 2019年4月8日星期一 下午8:10:41

如果电影、图书、Web网页或者单词按其流行性进行排名，那么下一个客户选择排行榜中排名为k的项的概率是C/k，其中C是一个归一化常数。
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9454-9455的标注 | 添加于 2019年4月8日星期一 下午8:11:04

相对流行性的一个合理的近似遵循着一种令人惊奇的可预测模式
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9453-9453的标注 | 添加于 2019年4月8日星期一 下午8:11:09

对于许多种类的流行性比赛，
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9469-9469的标注 | 添加于 2019年4月8日星期一 下午8:13:42

服务器需要大量的电影，因为对于前10名以外的电影存在着潜在的需求。
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9470-9471的标注 | 添加于 2019年4月8日星期一 下午8:13:52

了解不同电影的相对流行性，使得对视频服务器的性能进行建模以及将该信息应用于存放文件成为可能
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9471-9472的标注 | 添加于 2019年4月8日星期一 下午8:14:14

管风琴算法（organ-pipe algorithm）（
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9472-9473的标注 | 添加于 2019年4月8日星期一 下午8:14:32

1983）。该算法将最流行的电影存放在磁盘的中央，第二和第三流行的电影存放在最流行的电影的两边，在这几部电影的外边是排名第四和第五的电影，以此类推，如图7-23所示。
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9475-9475的标注 | 添加于 2019年4月8日星期一 下午8:14:49

概率直方图看起来像是一个稍稍不
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9475-9476的标注 | 添加于 2019年4月8日星期一 下午8:14:52

概率直方图看起来像是一个稍稍不对称的管风琴。
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9477-9477的标注 | 添加于 2019年4月8日星期一 下午8:15:22

该算法所做的是试图将磁头保持在磁盘的中央
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9482-9482的标注 | 添加于 2019年4月8日星期一 下午8:15:50

### 7.7.5　在多个磁盘上存放文件

RAID有时会被用到，但是通常并不是因为RAID以性能为代价提供了更高的可靠性。
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9485-9486的标注 | 添加于 2019年4月8日星期一 下午8:16:59

更为普通的配置只是数目很多的磁盘，有时被称为磁盘园（disk farm）。
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9487-9487的标注 | 添加于 2019年4月8日星期一 下午8:17:17

一种可能的配置是将电影A存放在磁盘1上，将电影B存放在磁盘2上
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9490-9491的标注 | 添加于 2019年4月8日星期一 下午8:18:06

这一组织方式实现起来很简单，并且具有简单明了的故障特性：如果一块磁盘发生故障，其上的所有电影都将不再可用
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9493-9493的标注 | 添加于 2019年4月8日星期一 下午8:18:37

这一方法的缺点是负载可能没有很好地平衡，
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9495-9496的标注 | 添加于 2019年4月8日星期一 下午8:18:56

第二种可能的组织方式是将每一部电影在多块磁盘上分成条带，图7-24b所示为4部电影的例子。
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9499-9500的标注 | 添加于 2019年4月8日星期一 下午8:19:45


由于所有的电影在第一块磁盘开始，这一条带模式的一个可能的缺点是跨磁盘的负载可能不平衡。一种更好地分散负载的方法是交错起始磁盘，如图7-24c所示。还有一种试图平衡负载的方法是对每一文件使用随机的条带模式，如图7-24d所示。
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9502-9502的标注 | 添加于 2019年4月8日星期一 下午8:20:18


对于MPEG-2电影，这一假设是错误的：I帧比P帧要大得多。有两种方法可以处理这一新出现的问题：按帧分条带或按块分条带。
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9507-9507的标注 | 添加于 2019年4月8日星期一 下午8:24:54

，在所有的磁盘间分散负载将更好地利用总的磁盘带宽，并因此而增加能够服务的顾客数目。
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9508-9508的标注 | 添加于 2019年4月8日星期一 下午8:34:38

分条带的另一种方法是按块分条带。
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9513-9513的标注 | 添加于 2019年4月8日星期一 下午8:36:27

这一方法使用了大量的内存作为缓冲区，从而使磁盘保持忙碌。
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9515-9516的标注 | 添加于 2019年4月8日星期一 下午9:06:31

关于条带的最后一个问题是在多少个磁盘上分条带。在一个极端，每部电影将在所有的磁盘上分成条带。
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9517-9518的标注 | 添加于 2019年4月8日星期一 下午9:06:59

在另一个极端，磁盘被分区为小的组（如同图7-24那样），并且每部电影被限制在一个分区中。
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9517-9519的标注 | 添加于 2019年4月8日星期一 下午9:07:08

在另一个极端，磁盘被分区为小的组（如同图7-24那样），并且每部电影被限制在一个分区中。前者称为宽条带（wide striping），它在平衡磁盘间负载方面工作良好。
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9519-9521的标注 | 添加于 2019年4月8日星期一 下午9:07:31

后者称为窄条带（narrow striping），它将遭遇热点（广受欢迎的分区）的问题，但是损失一块磁盘将只是葬送存放在其分区中的电影
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9524-9525的标注 | 添加于 2019年4月8日星期一 下午9:07:55
## 7.8 高速缓存

传统的LRU文件高速缓存对于多媒体文件而言工作得并不好，这是因为电影的访问模式与文本文件有所不同
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9525-9526的标注 | 添加于 2019年4月8日星期一 下午9:08:43

LRU缓冲区高速缓存背后的思想是，当一个块被使用之后，应该将其保存在高速缓存中，以防很快再次需要访问它。
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9529-9529的标注 | 添加于 2019年4月8日星期一 下午9:16:01


对于多媒体而言，通常的访问模式是按顺序从头到尾观看一部电影。一个块不太可能被使用两次，
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9530-9530的标注 | 添加于 2019年4月8日星期一 下午9:20:03

因此，通常的高速缓存技术是行不通的。
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9532-9534的标注 | 添加于 2019年4月8日星期一 下午9:20:16

### 7.8.1　块高速缓存 
尽管只是将一个块保存起来期望它可能很快再次被用到是没有意义的，但是可以利用多媒体系统的可预测性，使高速缓存再度成为十分有益的技术。
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9536-9538的标注 | 添加于 2019年4月8日星期一 下午9:28:10

只要一部电影中的一个块读出后很快会再次需要，对其进行高速缓存就是有意义的，当然是否进行高速缓存还取决于它要被高速缓存多长时间以及内存有多紧张
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9539-9540的标注 | 添加于 2019年4月8日星期一 下午9:28:35

对于在第一个观众之后∆T时间之内有第二个观众的每一部电影，可以将其标记为可高速缓存的，并且高速缓存其所有磁盘块直到第二个观众（也可能是第三个观众）使用。
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9539-9541的标注 | 添加于 2019年4月8日星期一 下午9:28:41

对于在第一个观众之后∆T时间之内有第二个观众的每一部电影，可以将其标记为可高速缓存的，并且高速缓存其所有磁盘块直到第二个观众（也可能是第三个观众）使用。对于其他的电影，根本不需要进行高速缓存。
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9541-9542的标注 | 添加于 2019年4月8日星期一 下午9:28:51

在某些情况下合并两个视频流是可行的。
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9543-9544的标注 | 添加于 2019年4月8日星期一 下午9:29:05

一种替代的方法是试图使两部电影同步，这一方法可以通过改变两部电影的帧率实现，图7-25演示了这一思想。
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9552-9553的标注 | 添加于 2019年4月8日星期一 下午9:32:16

一种降低一个用户的速度以便与另一个视频流合并的可选方法是，给用户以在他们的电影中包含广告的选项，与无广告的电影相比，其观看价格比较低。
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9554-9555的标注 | 添加于 2019年4月8日星期一 下午9:32:44

通过对广告的数目、长度和时间安排进行巧妙的操作，视频流就可以被阻滞足够长的时间，以便与期望的视频流取得同步（
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9558-9559的标注 | 添加于 2019年4月8日星期一 下午9:32:59

### 7.8.2 文件高速缓存
在多媒体系统中高速缓存还能够以不同的方式提供帮助。
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9561-9561的标注 | 添加于 2019年4月8日星期一 下午9:33:33

大多数视频服务器维护着一个请求最频繁的电影的磁盘高速缓存。
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9559-9560的标注 | 添加于 2019年4月8日星期一 下午9:33:44

视频服务器通常不能在磁盘上存放所有这些文件，所以要将它们存放在DVD或磁带上。
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9558-9560的标注 | 添加于 2019年4月8日星期一 下午9:33:53

由于大多数电影都非常大（3～6GB），视频服务器通常不能在磁盘上存放所有这些文件，所以要将它们存放在DVD或磁带上。
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9559-9560的标注 | 添加于 2019年4月8日星期一 下午9:34:01

使用高速缓存的另一种方法是在磁盘上保存每部电影的最初几分钟
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9569-9570的标注 | 添加于 2019年4月8日星期一 下午9:37:04
## 7.9 多媒体磁盘调度
多媒体对磁盘提出了与传统的、面向文本的应用程序（例如编译器或字处理器）有所不同的要求
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9573-9575的标注 | 添加于 2019年4月8日星期一 下午9:37:19

### 7.9.1　静态磁盘调度 
尽管多媒体对系统的所有部分提出了巨大的实时和数据率要求，但是它还有一个特性使其比传统的系统更加容易处理，这就是可预测性。
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9577-9577的标注 | 添加于 2019年4月8日星期一 下午9:37:40

多媒体就不同了，每个活动的视频流对系统施加明确的负载，使系统成为高度可预测的。
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9579-9580的标注 | 添加于 2019年4月8日星期一 下午9:38:34

这一可预测的负载可以用来使用为多媒体剪裁的算法对磁盘进行调度。下面
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9579-9580的标注 | 添加于 2019年4月8日星期一 下午9:38:39


我们将假设存在10个用户，每个用户观看不同的电影。
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9582-9582的标注 | 添加于 2019年4月8日星期一 下午9:39:08


根据系统的其他部分，计算机可能有10个进程，每个视频流一个进程，
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9584-9585的标注 | 添加于 2019年4月8日星期一 下午9:39:29


时间被分割成回环（round），在这里一个回环是一帧的时间（对于NTSC是33.3ms，对于PAL是40ms）。在每一回环的开始，为每个用户生成一个磁盘请求
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9588-9589的标注 | 添加于 2019年4月8日星期一 下午9:48:21

以优化的方法对请求排序，可能是以柱面顺序（可以想象在某些情形也可能以扇区顺序）排序，然后以优化的顺序对它们进行处理
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9593-9594的标注 | 添加于 2019年4月8日星期一 下午9:51:02

像这样优化磁盘请求增加了服务器可以同时传送的电影数。回环末尾的富余时间还可以用来服务可能存在的任何非实时请求。
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9594-9595的标注 | 添加于 2019年4月8日星期一 下午10:00:21

如果服务器有太多的视频流，偶尔也会出现当要求从磁盘的边缘部分读取帧时错过了最终时限的情况。
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9595-9596的标注 | 添加于 2019年4月8日星期一 下午10:00:34

只要错过最终时限的情况足够稀少，以此换取同时处理更多的视频流还是可以容忍的。
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9594-9596的标注 | 添加于 2019年4月8日星期一 下午10:00:39

如果服务器有太多的视频流，偶尔也会出现当要求从磁盘的边缘部分读取帧时错过了最终时限的情况。但是，只要错过最终时限的情况足够稀少，以此换取同时处理更多的视频流还是可以容忍的。
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9597-9598的标注 | 添加于 2019年4月8日星期一 下午10:03:16

为了保持输出给客户的数据流运行流畅，在服务器中采用双缓冲是必要的。
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9602-9603的标注 | 添加于 2019年4月8日星期一 下午10:04:10

每一回环可以从磁盘中读取两帧（假设一对帧连续地存放在磁盘上）。这一设计将磁盘操作的数目减少了一半，其代价是所需缓冲区空间的数量增加了一倍
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9608-9608的标注 | 添加于 2019年4月8日星期一 下午10:04:51

### 7.9.2　动态磁盘调度

假设所有的视频流具有相同的分辨率、帧率和其他特性，现在让我们放弃这一假设
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9610-9610的标注 | 添加于 2019年4月8日星期一 下午10:05:55

对磁盘的请求或多或少是随机到来的。
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9610-9611的标注 | 添加于 2019年4月8日星期一 下午10:06:39

每一读请求需要指定要读的是哪一磁盘块，另外还要指定什么时间需要该磁盘块，也就是最终时限
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9610-9612的标注 | 添加于 2019年4月8日星期一 下午10:06:57

每一读请求需要指定要读的是哪一磁盘块，另外还要指定什么时间需要该磁盘块，也就是最终时限。为简单起见，我们假设对于每次请求实际的服务时间是相同的（尽管这肯定是不真实的）。
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9618-9619的标注 | 添加于 2019年4月8日星期一 下午11:39:28

“使用什么算法选择下一个要服务的请求？”
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9619-9620的标注 | 添加于 2019年4月8日星期一 下午11:39:33

有两个因素起着重要的作用：最终时限和柱面。
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9622-9624的标注 | 添加于 2019年4月8日星期一 下午11:40:20

使用scan-EDF算法（scan-EDF algorithm）（Reddy和Wyllie，1994）可以将这两个因素结合起来。这一算法的思想是，将最终时限比较接近的请求收集在一起分成若干批，并且以柱面的顺序对其进行处理。
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9624-9625的标注 | 添加于 2019年4月8日星期一 下午11:41:30

我们考虑图7-27当t=700时的情形。磁盘驱动器知道它有11个挂起的请求，这些请求具有不同的最终时限和不同的柱面。
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9626-9627的标注 | 添加于 2019年4月8日星期一 下午11:42:09

顺序将是110、330、440、676和680。
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9626-9627的标注 | 添加于 2019年4月8日星期一 下午11:42:13

于是，顺序将是110、330、440、676和680。
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9624-9624的标注 | 添加于 2019年4月8日星期一 下午11:42:22

我们考虑图7-27当t=700时
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9624-9625的标注 | 添加于 2019年4月8日星期一 下午11:42:26

我们考虑图7-27当t=700时的情形。
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9631-9632的标注 | 添加于 2019年4月8日星期一 下午11:42:50

存在两种方法计算是否接纳新的客户。一种方法是假设每个客户平均地需要某些数量的资源，如磁盘带宽、内存缓冲区、CPU时间等
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9633-9635的标注 | 添加于 2019年4月8日星期一 下午11:43:20

另一种算法更为复杂。它要关注新顾客想要看的特定的电影，查找该电影的（预先计算的）数据率，而对于黑白片和彩色片、卡通片和故事片、爱情片和战争片，数据率都不相同。
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9641-9641的标注 | 添加于 2019年4月8日星期一 下午11:43:59

研究中有许多是关于内容、构造工具和应用的，
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9641-9642的标注 | 添加于 2019年4月8日星期一 下午11:44:05


另一个热门领域是多媒体与网络
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9642-9643的标注 | 添加于 2019年4月8日星期一 下午11:44:20

关于多媒体服务器的研究，尤其是分布式服务器与操作系统是相关的
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9643-9644的标注 | 添加于 2019年4月8日星期一 下午11:44:32

支持多媒体的文件系统也是与操作系统相关的研究（
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9644-9645的标注 | 添加于 2019年4月8日星期一 下午11:44:45

优秀的音频和视频编码（尤其是3D应用）对于高性能是很关键的。
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9646-9646的标注 | 添加于 2019年4月8日星期一 下午11:44:55

服务质量对多媒体系统非常重要，所以吸引了相当的关注（
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9648-9649的标注 | 添加于 2019年4月8日星期一 下午11:45:12

在为付费客户提供多媒体广播编排服务时，安全就变得很重要了
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9652-9653的标注 | 添加于 2019年4月8日星期一 下午11:45:22

多媒体是一种非常有前途的计算机应用
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9654-9655的标注 | 添加于 2019年4月8日星期一 下午11:45:33

多媒体文件包含多重平行的轨迹，通常有一个视频轨迹和至少一个音频轨迹，有时还有一些字幕轨迹。在回放期间，这些轨迹都必须保持同步。
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9655-9655的标注 | 添加于 2019年4月8日星期一 下午11:45:57

音频通过周期性地对音量进行采样而得以记录下来，
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9656-9657的标注 | 添加于 2019年4月8日星期一 下午11:46:10

压缩可以应用于音频信号，得到大约10倍的均匀的压缩率。视频压缩可以使用帧内压缩（JPEG），也可以使用帧间压缩（MPEG）。
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9658-9659的标注 | 添加于 2019年4月8日星期一 下午11:46:32

多媒体需要实时调度以便满足其最终时限。通常使用的算法有两个。第一个算法是速率单调调度，
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9659-9660的标注 | 添加于 2019年4月8日星期一 下午11:46:41

第二个算法是最早最终时限优先调度，
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9660-9661的标注 | 添加于 2019年4月8日星期一 下午11:47:02

EDF更复杂一些，但是它可以达到100%的利用率，而RMS有时不能达到。
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9661-9662的标注 | 添加于 2019年4月8日星期一 下午11:47:07

多媒体文件系统通常使用推送型模型而不是拉取型模型
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9663-9664的标注 | 添加于 2019年4月8日星期一 下午11:47:17

文件可以连续存放也可以不连续存放。
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9665-9665的标注 | 添加于 2019年4月8日星期一 下午11:47:28

磁盘上文件的存放格局影响
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9665-9666的标注 | 添加于 2019年4月8日星期一 下午11:47:42

磁盘上文件的存放格局影响着系统的性能。当存在多个文件时，有时使用风琴管算法
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9665-9666的标注 | 添加于 2019年4月8日星期一 下午11:48:00

磁盘上文件的存放格局影响着系统的性能。当存在多个文件时，有时使用风琴管算法。横跨多个磁盘将文件分成条带（无论是宽条带还是窄条带）也是常用的。为了
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9665-9666的标注 | 添加于 2019年4月8日星期一 下午11:48:03

磁盘上文件的存放格局影响着系统的性能。当存在多个文件时，有时使用风琴管算法。横跨多个磁盘将文件分成条带（无论是宽条带还是窄条带）也是常用的。
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9667-9667的标注 | 添加于 2019年4月8日星期一 下午11:48:15

磁盘块与文件高速缓存策略也得到了广泛
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9671-9672的标注 | 添加于 2019年4月9日星期二 下午12:47:25

对640像素）。利用正文中提供的信息，它需要的带宽比标准电视多多少？
==========
现代操作系统（原书第3版） (计算机科学丛书) (Andrews Tanenbaum)
- 您在位置 #9746-9747的标注 | 添加于 2019年4月9日星期二 下午6:46:30
